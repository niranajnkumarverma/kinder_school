{% extends 'user/base.html' %}
{% block content %}
{% load static %}
<style>
    table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

    td,
    th {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even) {
        background-color: #dddddd;
    }
</style>
<style>
    #circle {
        border-radius: 50% 50% 50% 50%;
        width: 50px;
        height: 50px;
    }
</style>

<br></br>
<div class="container">
    {% if cart_data.cart %}
    <div class="row">
        <div class="col-md-8 recipt-sec padding-30 mb-xl-30 ">
            <h3>Your Orders: {{cart_data.total_cart}}</h3>
            <div class="table-responsive table-striped">

                <table class="table" border="1">
                    <thead class="thead-dark">
                        <tr>
                            <th>Product</th>
                            <th>Price</th>
                            <th>Qunantity</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for cart in cart_data.cart %}
                        <tr>
                            <td data-title="Product">
                                <div class="cart-product">
                                    <img id="circle" src="{{cart.product.product_image.url}}">
                                    <div class="cart-product-body">
                                        <h6> <a href="#">{{cart.product.product_name}}</a></h6>

                                    </div>
                                </div>
                            </td>
                            <td data-title="Price"> <strong><i class="fa fa-rupee-sign"></i>
                                    {{cart.product.product_price}}</strong> </td>
                            <td class="quantity" data-title="quantity">
                                <form method="POST" action="{% url 'order:updatecart' pk=cart.pk %}"
                                    onchange="this.submit();">
                                    {% csrf_token %}
                                    <input type="number" name="qty" min="1" max="10" class="qty form-control"
                                        value="{{cart.quantity}}">
                                </form>
                            </td>
                            <td data-title="Total">
                                <strong><i class="fa fa-rupee-sign"></i> {{cart.total}}</strong>
                            </td>

                            <td>
                                <p class="center" title="Delete"><a href="{% url 'order:deletecart' pk=cart.pk %}"
                                        class="btn btn-danger btn-xs" data-title="Delete"><span
                                            class="glyphicon glyphicon-trash"></span></a></p>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <div class="col-md-4">
            <div class="recipt-sec padding-30 mb-0">
                <h3>Cart Total</h3>
                <div class="table-responsive">
                    <table class="table" border="1">
                        <tbody>
                            <tr>
                                <th>Subtotal</th>
                                <td><i class="fa fa-rupee-sign"></i> {{cart_data.total_cart_amount}}</td>
                            </tr>
                            <tr>
                                <th>Tax</th>
                                <td><i class="fa fa-rupee-sign"></i> {{cart_data.tax}} (18%)</i>
                                </td>
                            </tr>
                            <tr>
                                <th>Total</th>
                                <td> <b><i class="fa fa-rupee-sign"></i> {{cart_data.final_amount}}</b> </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="form-group">
                    <form name="pay" action="{% url 'order:pay' %}" method="POST">
                        {% csrf_token %}
                        <input type="hidden" name="amount" value="{{cart_data.final_amount}}">

                        <div class="form-group">
                            <a href="{% url 'student:profile_update' %}" class="btn btn-primary">Update Address</a>


                            <!-- <button type="submit" class="btn btn-primary">Pay with Paytm
                                {{cart_data.final_amount}}</button> -->
                            <input type="submit" value="Pay Pyatm INR  {{cart_data.final_amount}}" class="btn btn-primary py-3 px-4">
                        </div>
                    </form>
                    <form action="{% url 'order:create-checkout-session' %}" method="POST">
                        {% csrf_token %}
                        
                        <button type="submit" class="btn btn-danger">Pay with Card
                            {{cart_data.final_amount}}</button>

                        <!-- <div class="form-group">

                            <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                                data-key="{{ key }}" data-description="Book Payment Gateway"
                                data-amount={{cart_data.final_amount}}
                                data-locale = "auto">

                                </script>

                        </div> -->
                    </form>
                   
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <div class="col-md-12 ftco-animate">
        <div class="text-center">
            <span class="icon-remove_shopping_cart" style="font-size: 5rem"></span>
            <h2 class="mt-3">Your cart is empty!!!!.</h2>
        </div>
    </div>
    {% endif %}
    
</div>
<br>
{% endblock %}